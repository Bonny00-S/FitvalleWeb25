@model Fitvalle_25.Models.Viewmodels.UnifiedRequestVM

@{
    Layout = "~/Views/Shared/_LayoutCoach.cshtml";
    ViewData["Title"] = "Detalle de Solicitud";
}

<div class="card-fitvalle max-w-3xl mx-auto p-8 animate__animated animate__fadeIn">
    <h2 class="text-3xl font-bold mb-6 text-center text-[var(--color-primary)] font-[Poppins] flex items-center justify-center gap-2">
        <i data-lucide="file-text" class="icon active"></i>
        Solicitud de @Model.StudentName
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-[var(--color-text-secondary)]">
        <div class="space-y-2">
            <p class="flex items-center gap-2">
                <i data-lucide="mail" class="icon"></i>
                <span class="font-semibold text-[var(--color-text-primary)]">Email:</span> @Model.Email
            </p>
            @if (Model.Age.HasValue)
            {
                <p class="flex items-center gap-2">
                    <i data-lucide="cake" class="icon"></i>
                    <span class="font-semibold text-[var(--color-text-primary)]">Edad:</span> @Model.Age años
                </p>
            }
            @if (!string.IsNullOrEmpty(Model.Height))
            {
                <p class="flex items-center gap-2">
                    <i data-lucide="ruler" class="icon"></i>
                    <span class="font-semibold text-[var(--color-text-primary)]">Altura:</span> @Model.Height cm
                </p>
            }
            @if (!string.IsNullOrEmpty(Model.Weight))
            {
                <p class="flex items-center gap-2">
                    <i data-lucide="weight" class="icon"></i>
                    <span class="font-semibold text-[var(--color-text-primary)]">Peso actual:</span> @Model.Weight kg
                </p>
            }
        </div>

        <div class="space-y-2">
            @if (!string.IsNullOrEmpty(Model.GoalWeight))
            {
                <p class="flex items-center gap-2">
                    <i data-lucide="trophy" class="icon"></i>
                    <span class="font-semibold text-[var(--color-text-primary)]">Meta de peso:</span> @Model.GoalWeight kg
                </p>
            }
            @if (!string.IsNullOrEmpty(Model.RegisterDate))
            {
                <p class="flex items-center gap-2">
                    <i data-lucide="calendar" class="icon"></i>
                    <span class="font-semibold text-[var(--color-text-primary)]">Registro:</span> @Model.RegisterDate
                </p>
            }
            <p class="flex items-center gap-2">
                <i data-lucide="activity" class="icon"></i>
                <span class="font-semibold text-[var(--color-text-primary)]">Estado:</span>
                @if (Model.State.ToLower() == "accepted")
                {
                    <span class="text-[var(--color-success)] font-semibold">Aceptada</span>
                }
                else if (Model.State.ToLower() == "pending")
                {
                    <span class="text-[var(--color-warning)] font-semibold">Pendiente</span>
                }
                else if (Model.State.ToLower() == "rejected")
                {
                    <span class="text-[var(--color-error)] font-semibold">Rechazada</span>
                }
                else
                {
                    <span class="text-[var(--color-text-secondary)]">@Model.State</span>
                }
            </p>
        </div>
    </div>

    @if (Model.Type == "tutoring" && !string.IsNullOrEmpty(Model.Message) && string.IsNullOrEmpty(Model.Message))
    {
        <hr class="my-6 border-[var(--color-primary)]/40">

        <h3 class="text-lg font-semibold text-[var(--color-primary)] mb-2 font-[Poppins] flex items-center gap-2">
            <i data-lucide="message-circle" class="icon"></i>
            Mensaje de Tutoría
        </h3>

        <div class="bg-[var(--color-surface)] border border-[var(--color-primary)]/30 rounded-lg p-4 text-[var(--color-text-secondary)] whitespace-pre-line shadow-sm">
            @Model.Message
        </div>
      
    }

    @if (Model.Type == "tutoring" && !string.IsNullOrEmpty(Model.Message) && !string.IsNullOrEmpty(Model.Description))
    {
        <hr class="my-6 border-[var(--color-primary)]/40">

        <h3 class="text-lg font-semibold text-[var(--color-primary)] mb-2 font-[Poppins] flex items-center gap-2">
            <i data-lucide="message-circle" class="icon"></i>
            Mensaje de Tutoría
        </h3>

        <div class="bg-[var(--color-surface)] border border-[var(--color-primary)]/30 rounded-lg p-4 text-[var(--color-text-secondary)] whitespace-pre-line shadow-sm">
            @Model.Message
        </div>
        <hr class="my-6 border-[var(--color-primary)]/40">

        <h3 class="text-lg font-semibold text-[var(--color-primary)] mb-2 font-[Poppins] flex items-center gap-2">
            <i data-lucide="clipboard-list" class="icon"></i>
            Preferencias de entrenamiento
        </h3>

        <div class="bg-[var(--color-surface)] border border-[var(--color-primary)]/30 rounded-lg p-4 text-[var(--color-text-secondary)] whitespace-pre-line shadow-sm">
            @Model.Description
        </div>
    }

    @if (Model.Type == "general" && !string.IsNullOrEmpty(Model.Description))
    {
        <hr class="my-6 border-[var(--color-primary)]/40">

        <h3 class="text-lg font-semibold text-[var(--color-primary)] mb-2 font-[Poppins] flex items-center gap-2">
            <i data-lucide="clipboard-list" class="icon"></i>
            Preferencias de entrenamiento
        </h3>

        <div class="bg-[var(--color-surface)] border border-[var(--color-primary)]/30 rounded-lg p-4 text-[var(--color-text-secondary)] whitespace-pre-line shadow-sm">
            @Model.Description
        </div>
    }


    <hr class="my-6 border-[var(--color-primary)]/40">

    <div class="mt-8 flex justify-center space-x-4">
        <a asp-action="RequestCustomers" asp-controller="Coach"
           class="bg-[var(--color-primary-hover)] hover:bg-[var(--color-primary)] text-white px-5 py-2 rounded-md font-[Poppins] transition duration-300 shadow inline-flex items-center gap-2">
            <i data-lucide="arrow-left" class="icon"></i>
            Volver
        </a>

        @if (Model.State.ToLower() != "accepted")
        {
            <form asp-action="AcceptRequest" method="post" class="inline">
                <input type="hidden" name="requestId" value="@Model.Id" />
                <input type="hidden" name="studentId" value="@Model.StudentId" />
                <button type="submit"
                        class="bg-[var(--color-success)] hover:bg-emerald-600 text-white px-5 py-2 rounded-md font-[Poppins] transition duration-300 shadow inline-flex items-center gap-2">
                    <i data-lucide="check" class="icon"></i>
                    Aceptar Alumno
                </button>
            </form>

            <form asp-action="RejectRequest" method="post" class="inline">
                <input type="hidden" name="requestId" value="@Model.Id" />
                <button type="submit"
                        class="bg-red-600 hover:bg-red-700
               text-white px-5 py-2 rounded-md
               font-[Poppins] transition duration-300
               shadow inline-flex items-center gap-2">
                    <i data-lucide="x-circle" class="icon"></i>
                    Rechazar
                </button>

            </form>
        }
        else
        {
            <span class="text-[var(--color-success)] font-semibold flex items-center gap-2">
                <i data-lucide="check-circle" class="icon"></i>
                Alumno asignado
            </span>
        }
    </div>
</div>

@section Scripts {
    <script>
        lucide.createIcons();
    </script>
}


@* @model (Fitvalle_25.Models.Request solicitud, Fitvalle_25.Models.User cliente, Fitvalle_25.Models.Customer customer, int edad)

@{
    Layout = "~/Views/Shared/_LayoutCoach.cshtml";
    ViewData["Title"] = "Detalle de Solicitud";

    var s = Model.solicitud;
    var u = Model.cliente;
    var c = Model.customer;
    var edad = Model.edad;
}

<div class="card-fitvalle max-w-3xl mx-auto p-8 animate__animated animate__fadeIn">
    <h2 class="text-3xl font-bold mb-6 text-center text-[var(--color-primary)] font-[Poppins] flex items-center justify-center gap-2">
        <i data-lucide="file-text" class="icon active"></i>
        Solicitud de @u.Name
    </h2>

    <!-- 🧍 Datos del cliente -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-[var(--color-text-secondary)]">
        <div class="space-y-2">
            <p class="flex items-center gap-2">
                <i data-lucide="mail" class="icon"></i>
                <span class="font-semibold text-[var(--color-text-primary)]">Email:</span> @u.Email
            </p>
            <p class="flex items-center gap-2">
                <i data-lucide="cake" class="icon"></i>
                <span class="font-semibold text-[var(--color-text-primary)]">Edad:</span> @edad años
            </p>
            <p class="flex items-center gap-2">
                <i data-lucide="ruler" class="icon"></i>
                <span class="font-semibold text-[var(--color-text-primary)]">Altura:</span> @c.Height cm
            </p>
            <p class="flex items-center gap-2">
                <i data-lucide="weight" class="icon"></i>
                <span class="font-semibold text-[var(--color-text-primary)]">Peso actual:</span> @c.Weight kg
            </p>
        </div>

        <div class="space-y-2">
            <p class="flex items-center gap-2">
                <i data-lucide="trophy" class="icon"></i>
                <span class="font-semibold text-[var(--color-text-primary)]">Meta de peso:</span> @c.GoalWeight kg
            </p>
            <p class="flex items-center gap-2">
                <i data-lucide="calendar" class="icon"></i>
                <span class="font-semibold text-[var(--color-text-primary)]">Registro:</span> @c.RegisterDate
            </p>
            <p class="flex items-center gap-2">
                <i data-lucide="activity" class="icon"></i>
                <span class="font-semibold text-[var(--color-text-primary)]">Estado:</span>
                @if (s.State == "accepted")
                {
                    <span class="text-[var(--color-success)] font-semibold">Aceptada</span>
                }
                else if (s.State == "pending")
                {
                    <span class="text-[var(--color-warning)] font-semibold">Pendiente</span>
                }
                else
                {
                    <span class="text-[var(--color-text-secondary)]">@s.State</span>
                }
            </p>
        </div>
    </div>

    <hr class="my-6 border-[var(--color-primary)]/40">

    <!-- 🧾 Descripción -->
    <h3 class="text-lg font-semibold text-[var(--color-primary)] mb-2 font-[Poppins] flex items-center gap-2">
        <i data-lucide="clipboard-list" class="icon"></i>
        Preferencias de entrenamiento
    </h3>

    <div class="bg-[var(--color-surface)] border border-[var(--color-primary)]/30 rounded-lg p-4 text-[var(--color-text-secondary)] whitespace-pre-line shadow-sm">
        @s.Description
    </div>

    <!-- 🔘 Botones -->
    <div class="mt-8 flex justify-center space-x-4">
        <a asp-action="RequestCustomers" asp-controller="Coach"
           class="bg-[var(--color-primary-hover)] hover:bg-[var(--color-primary)] text-white px-5 py-2 rounded-md font-[Poppins] transition duration-300 shadow inline-flex items-center gap-2">
            <i data-lucide="arrow-left" class="icon"></i>
            Volver
        </a>

        @if (s.State != "accepted")
        {
            <form asp-action="AcceptRequest" method="post" class="inline">
                <input type="hidden" name="requestId" value="@s.Id" />
                <input type="hidden" name="customerId" value="@s.CustomerId" />
                <button type="submit"
                        class="bg-[var(--color-success)] hover:bg-emerald-600 text-white px-5 py-2 rounded-md font-[Poppins] transition duration-300 shadow inline-flex items-center gap-2">
                    <i data-lucide="check" class="icon"></i>
                    Aceptar Alumno
                </button>
            </form>
        }
        else
        {
            <span class="text-[var(--color-success)] font-semibold flex items-center gap-2">
                <i data-lucide="check-circle" class="icon"></i>
                Alumno asignado
            </span>
        }
    </div>
</div>

@section Scripts {
    <script>
        lucide.createIcons();
    </script>
}
 *@