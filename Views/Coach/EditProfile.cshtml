@model Fitvalle_25.Models.User
@{
    Layout = "~/Views/Shared/_LayoutCoach.cshtml";
    ViewData["Title"] = "Editar Perfil";
}

<div class="max-w-5xl mx-auto p-10 card-fitvalle animate__animated animate__fadeIn">
    <h2 class="text-3xl font-[Poppins] font-bold mb-6 text-[var(--color-text-primary)] flex items-center gap-2">
        <i data-lucide="edit" class="icon active"></i> Editar Perfil
    </h2>

    <form asp-action="UpdateProfile" method="post" enctype="multipart/form-data" class="space-y-6">
        <!-- Imagen de perfil -->
        <div class="flex flex-col items-center relative">
            <label for="photo" class="cursor-pointer group relative">
                <img id="photoPreview"
                     src="@(!string.IsNullOrEmpty(Model.PhotoUrl) ? Model.PhotoUrl : "/images/iconUser.png")"
                     class="w-44 h-44 rounded-full border-4 border-[var(--color-primary)] shadow-lg object-cover transition-transform duration-300 group-hover:scale-105" />
                <div class="absolute inset-0 flex items-center justify-center bg-black/40 opacity-0 group-hover:opacity-100 rounded-full transition">
                    <i data-lucide="camera" class="text-white w-6 h-6"></i>
                </div>
            </label>
            <input id="photo" name="photo" type="file" accept="image/*" class="hidden" />
        </div>

        <!-- Nombre -->
        <div>
            <label class="block text-[var(--color-text-secondary)] font-semibold mb-1">Nombre</label>
            <input asp-for="Name"
                   class="w-full p-3 rounded-lg border border-gray-300 bg-[var(--color-background-light)]
                          text-[var(--color-text-primary)] focus:border-[var(--color-primary)]
                          focus:ring-[var(--color-primary)] focus:ring-1 outline-none transition" />
        </div>

        <!-- Descripción -->
        <div>
            <label class="block text-[var(--color-text-secondary)] font-semibold mb-1">Descripción</label>
            <textarea asp-for="Description"
                      class="w-full p-3 rounded-lg border border-gray-300 bg-[var(--color-background-light)]
                             text-[var(--color-text-primary)] focus:border-[var(--color-primary)]
                             focus:ring-[var(--color-primary)] focus:ring-1 outline-none transition min-h-[120px]"></textarea>
        </div>

        <div>
            <label class="block text-[var(--color-text-secondary)] font-semibold mb-1">Especialidad</label>
            <input asp-for="Specialty"
                   class="w-full p-3 rounded-lg border border-gray-300 bg-[var(--color-background-light)]
                          text-[var(--color-text-primary)] focus:border-[var(--color-primary)]
                          focus:ring-[var(--color-primary)] focus:ring-1 outline-none transition"
                   placeholder="Ej. Entrenamiento funcional, Nutrición, etc." />
        </div>

        <!-- Botones -->
        <div class="flex gap-4">
            <button type="submit"
                    class="flex-1 bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)]
                           text-white px-4 py-2 rounded-lg shadow transition duration-300 font-semibold">
                Guardar cambios
            </button>

            <a asp-action="ProfileCoach"
               class="flex-1 text-center bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)]
                      text-white px-4 py-2 rounded-lg shadow transition duration-300 font-semibold">
                Cancelar
            </a>
        </div>
    </form>
</div>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            lucide.createIcons();

            const input = document.getElementById("photo");
            const preview = document.getElementById("photoPreview");

            input.addEventListener("change", (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        preview.src = event.target.result;
                        preview.classList.add("animate__animated", "animate__fadeIn");
                    };
                    reader.readAsDataURL(file);
                }
            });
        });
    </script>
}
